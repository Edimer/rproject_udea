---
title: "Diseño Exprimental"
subtitle: "Datos empíricos y experimentales"
output:
  html_document:
    toc: true
    toc_float:
      scroll_smooth: false
      collapsed: false
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE,
                      fig.align = "center")
```

# Bibliotecas 

```{r}
library(tidyverse)
library(readxl)
library(janitor)
```

# Datos

```{r}
datos <- read_excel("Simpson-Calidad-Leche.xls") %>% 
  clean_names() %>% 
  mutate(across(c(fat_g_100_ml, protein_g_100_ml, lactose_g_100_ml,
                  inv_simpson), as.numeric))

datos
```

# Tipos de datos

```{r}
datos %>% 
  glimpse()
```


# Pregunta

- **¿Qué variables inciden en la diversidad de la microbiota fecal?**

```{r}
datos %>% names()
```

# Alternativas de respuesta

- Métricas estadísticas
- Tablas
- Gráficos **¿Qué tipo de gráficos?**

# Gráfico 1

- En el siguiente gráfico queremos mostrar cómo se distribuye la variable "inv_simpson" por raza:

```{r}
datos %>% 
  ggplot(aes(x = inv_simpson, fill = race)) +
  geom_density(alpha = 0.5)
```


# Gráfico 2

- En el gráfico anterior observamos la distribución de la variable "inv_simpson" en función de la raza, sin embargo, podríamos estar interesados en representar dos métricas, por ejemplo, el promedio y la desviación estándar, para cada raza.

```{r}
datos %>%
  group_by(race) %>%
  summarise(promedio = mean(inv_simpson),
            desviacion = sd(inv_simpson)) %>%
  ungroup() %>%
  ggplot(aes(
    x = race,
    y = promedio,
    ymin = promedio - desviacion,
    ymax = promedio + desviacion
  )) +
  geom_point() +
  geom_errorbar(width = 0.1) 
```

- Al gráfico anterior podemos agregar el promedio general de la variable "inv_simpson":

```{r}
promedio_general <- datos %>%
  pull(inv_simpson) %>%
  mean()

datos %>%
  group_by(race) %>%
  summarise(promedio = mean(inv_simpson),
            desviacion = sd(inv_simpson)) %>%
  ungroup() %>%
  ggplot(aes(
    x = race,
    y = promedio,
    ymin = promedio - desviacion,
    ymax = promedio + desviacion
  )) +
  geom_point() +
  geom_errorbar(width = 0.1) +
  geom_hline(yintercept = promedio_general, lty = 2, color = "red")
```


# Gráfico 3

- Podemos explorar la interacción de la raza y el tipo de alimentación:

```{r}
datos %>% 
  group_by(race, alimentation) %>% 
  summarise(promedio = mean(inv_simpson, na.rm = TRUE)) %>% 
  ggplot(aes(x = race, y = promedio, color = alimentation)) +
  geom_point() +
  geom_line(aes(group = alimentation))
```

# Gráfico 4

- Hasta ahora hemos explorado la relación de la variable "inv_simpson" (**numérica**) con la raza (**categórica**) y el tipo de alimentación (**categórica**).
- **¿Qué gráfico o métrica podemos usar para representar la relación de dos variables numéricas?**
- **¿Qué gráfico o métrica podemos usar para representar la relación de más de dos variables numéricas?**
